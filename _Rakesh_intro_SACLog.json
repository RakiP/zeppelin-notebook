{"paragraphs":[{"text":"import com.sanoma.dsnl.spark_commons.input.{SACLog,SAC2Log}","user":"R.Partapsing","dateUpdated":"2019-07-08T11:15:30+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import com.sanoma.dsnl.spark_commons.input.{SACLog, SAC2Log}\n"}]},"apps":[],"jobName":"paragraph_1533555852287_-130197908","id":"20180806-114412_1361891431","dateCreated":"2018-08-06T11:44:12+0000","dateStarted":"2019-07-08T11:15:30+0000","dateFinished":"2019-07-08T11:15:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:174505"},{"text":"val dateFrom = \"2019-07-06\"\nval dateTo = \"2019-06-28\"\n\nval sacWeb = SACLog(dateFrom, dateTo)(spark).read()\n    \nval sacApp = SAC2Log(dateFrom, dateTo)(spark)\n    .read()","user":"R.Partapsing","dateUpdated":"2019-07-08T11:15:58+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"dateFrom: String = 2019-07-06\ndateTo: String = 2019-06-28\nsacWeb: org.apache.spark.rdd.RDD[com.sanoma.dsnl.sac.events.SACEvent] = MapPartitionsRDD[123] at map at SACLog.scala:44\nsacApp: org.apache.spark.rdd.RDD[com.sanoma.dsnl.sac.events.SACEvent] = MapPartitionsRDD[131] at map at SACLog.scala:89\n"}]},"apps":[],"jobName":"paragraph_1533555871723_-1749590704","id":"20180806-114431_305236380","dateCreated":"2018-08-06T11:44:31+0000","dateStarted":"2019-07-08T11:15:59+0000","dateFinished":"2019-07-08T11:16:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:174506"},{"text":"val sacAll = sacWeb ++ sacApp","user":"R.Partapsing","dateUpdated":"2019-07-08T11:18:41+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"sacAll: org.apache.spark.rdd.RDD[com.sanoma.dsnl.sac.events.SACEvent] = UnionRDD[132] at $plus$plus at <console>:48\n"}]},"apps":[],"jobName":"paragraph_1533555994905_1664487145","id":"20180806-114634_1364348068","dateCreated":"2018-08-06T11:46:34+0000","dateStarted":"2019-07-08T11:18:41+0000","dateFinished":"2019-07-08T11:18:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:174507"},{"text":"val sacAutoweekProdView = sacWeb\n      .filter{ e =>\n        val filter_site = e.sit == \"nunl\"\n        //val filter_action = e.custom.get(\"action\").contains(\"declined_breaking_smart\")\n        //val dt = new DateTime(e.ts)\n        //val dt1 = new DateTime(\"2019-03-29T12:37:12\", DateTimeZone.UTC)\n        //val filter_dt = dt.isAfter(dt1)\n        val filter_medium = e.cha == \"web\"\n        filter_site && filter_medium // && filter_action\n      }\n      .map{e => {\n        val dt = new DateTime(e.ts).toString()\n        val gigyaId = e.ids.gigya.map(_.toString)\n        //val action =  e.custom.get(\"action\")\n        //val pushTypes = e.custom.get(\"push_tags\")\n        //val spns_id = \"spns_device_secret:\" + e.custom.get(\"spns_device_secret\").get\n        val cid = e.custom.get(\"label\").get.split(\"_\")(0)\n        val contentUniqueId = ContentId(\"nunl\", ArticleType, cid).uniqueId\n        //(dt, gigyaId, contentUniqueId )\n        (dt)\n      }}\n      .toDF(\"time\")\n      //.toDF(\"time\", \"userUniqueId\", \"contentUniqueId\")\n      //.cache","user":"R.Partapsing","dateUpdated":"2019-07-08T11:30:45+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"sacAutoweekProdView: org.apache.spark.sql.DataFrame = [time: string]\n"}]},"apps":[],"jobName":"paragraph_1562585025633_-517795583","id":"20190708-112345_2117476976","dateCreated":"2019-07-08T11:23:45+0000","dateStarted":"2019-07-08T11:30:45+0000","dateFinished":"2019-07-08T11:30:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:174508"},{"text":"z.show(sacAutoweekProdView)","user":"R.Partapsing","dateUpdated":"2019-07-08T11:30:47+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"time":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"time\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1562585335808_-2055249557","id":"20190708-112855_826811692","dateCreated":"2019-07-08T11:28:55+0000","dateStarted":"2019-07-08T11:30:47+0000","dateFinished":"2019-07-08T11:30:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:174509"},{"text":"%md\n\n### Number of content views per site","user":"R.Partapsing","dateUpdated":"2018-08-06T11:52:28+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Number of content views per site</h3>\n"}]},"apps":[],"jobName":"paragraph_1533556317234_2040795116","id":"20180806-115157_157106787","dateCreated":"2018-08-06T11:51:57+0000","dateStarted":"2018-08-06T11:52:28+0000","dateFinished":"2018-08-06T11:52:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:174510"},{"text":"import com.sanoma.cda.sac.events.ContentId\nval tags = \"nunl:tag-name:Onderwijs,nunl:tag-name:Mama\"","user":"R.Partapsing","dateUpdated":"2019-01-29T14:01:08+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import com.sanoma.cda.sac.events.ContentId\ntags: String = nunl:tag-name:Onderwijs,nunl:tag-name:Mama\n"}]},"apps":[],"jobName":"paragraph_1548769281530_765047334","id":"20190129-134121_1295632757","dateCreated":"2019-01-29T13:41:21+0000","dateStarted":"2019-01-29T14:01:09+0000","dateFinished":"2019-01-29T14:01:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:174511"},{"text":"val tagsQuery = tags.split(\",\")","user":"R.Partapsing","dateUpdated":"2019-01-29T14:01:21+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"tagsQuery: Array[String] = Array(nunl:tag-name:Onderwijs, nunl:tag-name:Mama)\n"}]},"apps":[],"jobName":"paragraph_1548769800481_1112048159","id":"20190129-135000_236619422","dateCreated":"2019-01-29T13:50:00+0000","dateStarted":"2019-01-29T14:01:21+0000","dateFinished":"2019-01-29T14:01:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:174512"},{"text":"tagsQuery.flatMap(contentIdString =>println(contentIdString.toString))","user":"R.Partapsing","dateUpdated":"2019-01-29T13:50:31+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"<console>:29: error: type mismatch;\n found   : Unit\n required: scala.collection.GenTraversableOnce[?]\n       tagsQuery.flatMap(contentIdString =>println(contentIdString.toString))\n                                                  ^\n"}]},"apps":[],"jobName":"paragraph_1548769629682_1570044229","id":"20190129-134709_445104044","dateCreated":"2019-01-29T13:47:09+0000","dateStarted":"2019-01-29T13:50:31+0000","dateFinished":"2019-01-29T13:50:31+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:174513"},{"text":"tagsQuery.map(contentIdString => ContentId(contentIdString.toString).map(_.site))","user":"R.Partapsing","dateUpdated":"2019-01-29T13:50:37+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res8: Array[Option[String]] = Array(None, None)\n"}]},"apps":[],"jobName":"paragraph_1548769576442_506642514","id":"20190129-134616_880610225","dateCreated":"2019-01-29T13:46:16+0000","dateStarted":"2019-01-29T13:50:37+0000","dateFinished":"2019-01-29T13:50:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:174514"},{"text":"val ff =  ContentId(\"nunl:tag:twee\").map(_.contentType)","user":"R.Partapsing","dateUpdated":"2019-01-29T14:04:06+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ff: Option[com.sanoma.cda.sac.events.ContentItemType] = Some(tag)\n"}]},"apps":[],"jobName":"paragraph_1548769853832_-1173491793","id":"20190129-135053_3011771","dateCreated":"2019-01-29T13:50:53+0000","dateStarted":"2019-01-29T14:04:06+0000","dateFinished":"2019-01-29T14:04:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:174515"},{"text":"tagsQuery.map(rename => rename.replace(\"-name\",\"\"))","user":"R.Partapsing","dateUpdated":"2019-01-29T14:01:26+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res13: Array[String] = Array(nunl:tag:Onderwijs, nunl:tag:Mama)\n"}]},"apps":[],"jobName":"paragraph_1548770399083_270670305","id":"20190129-135959_1507353483","dateCreated":"2019-01-29T13:59:59+0000","dateStarted":"2019-01-29T14:01:26+0000","dateFinished":"2019-01-29T14:01:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:174516"},{"text":"tagsQuery.map(rename => rename.replace(\"-name\",\"\")).flatMap(contentIdString => ContentId(contentIdString.toString).map(_.contentType.toString))","user":"R.Partapsing","dateUpdated":"2019-01-29T14:07:56+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res17: Array[String] = Array(tag, tag)\n"}]},"apps":[],"jobName":"paragraph_1548769306543_-90763746","id":"20190129-134146_1181495333","dateCreated":"2019-01-29T13:41:46+0000","dateStarted":"2019-01-29T14:07:56+0000","dateFinished":"2019-01-29T14:07:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:174517"},{"text":"// let's do it using only the RDD API\n// Option[String] => when defined Some(\"string\"), when not defined None\n\nval contentViews = sacAll\n    .filter(event => event.content.isDefined)\n    .map{event => \n        val contentId = event.content.get\n        val contentType = contentId.contentType\n        (event.sit, contentType)\n    }\n    .cache()\n","user":"R.Partapsing","dateUpdated":"2018-08-06T12:46:21+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"contentViews: org.apache.spark.rdd.RDD[(String, com.sanoma.cda.sac.events.ContentItemType)] = MapPartitionsRDD[36] at map at <console>:44\n"}]},"apps":[],"jobName":"paragraph_1533556348820_1491034910","id":"20180806-115228_713103632","dateCreated":"2018-08-06T11:52:28+0000","dateStarted":"2018-08-06T12:09:17+0000","dateFinished":"2018-08-06T12:09:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:174518"},{"text":"val sacVtWonenProdView = sacAll\n      .filter{ e: SACEvent =>\n        val filter_site = e.sit == \"autoweek-nl\" && e.isPageView\n        val filter_product = e.custom.get(\"c_page_type\").contains(\"product_detail_page\")\n        val filter_contentId =  e.custom.get(\"c_r_sku\").isDefined\n        val filter_web = e.cha == \"web\"\n        filter_site// && filter_product && filter_contentId\n      }\n      .map{e: SACEvent => {\n        val dt = new DateTime(e.ts).toString(dateFormat)\n        val gigyaId = e.ids.gigya.map(_.toString)\n        val kruxId = e.ids.find(id => id.typ == UserIdType.Krux).map(_.toString)\n\n        // val krux9Id: Option[String] = e.eid match {\n        //       case kruxShortPattern(id) => Some(id)\n        //       case kruxLongPattern(id) => Some(id)\n        //       case _ => None\n        //     }\n\n        val contId = e.custom(\"c_r_sku\")\n        val sessionId = e.custom.get(\"c_session\")\n        val pageType =  e.custom.get(\"c_page_type\")\n        (dt, e.ids.device.get.toString, kruxId, gigyaId, e.cha, pageType, sessionId, e.cat, contId)\n      }}\n      .toDF(\"timestamp\", \"sac_id\", \"krux9_id\", \"gigya_id\", \"channel\", \"page_type\", \"session_id\", \"category\", \"cont_id\")","user":"R.Partapsing","dateUpdated":"2019-07-08T11:18:50+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"<console>:51: error: not found: type SACEvent\n             .filter{ e: SACEvent =>\n                         ^\n<console>:58: error: not found: type SACEvent\n             .map{e: SACEvent => {\n                     ^\n"}]},"apps":[],"jobName":"paragraph_1550237210152_1111406884","id":"20190215-132650_1179692792","dateCreated":"2019-02-15T13:26:50+0000","dateStarted":"2019-07-08T11:18:50+0000","dateFinished":"2019-07-08T11:18:50+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:174519"},{"text":"val contentViewsGrouped = contentViews\n    .groupBy{case(site, contentType) => (site, contentType)}\n    .countByKey()","user":"R.Partapsing","dateUpdated":"2018-08-06T12:16:47+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"contentViewsGrouped: scala.collection.Map[(String, com.sanoma.cda.sac.events.ContentItemType),Long] = Map((helmiradio-fi,article) -> 1, (vaalikone-fi,article) -> 1, (etlehti-fi,article) -> 1, (digilehdet-fi,article) -> 1, (nuwerk-nl,job-ad) -> 1, (nelonen-fi,article) -> 1, (toimitilat-oikotie-fi,article) -> 1, (autotie-fi,article) -> 1, (sanoma-fi,article) -> 1, (nunl,article) -> 1, (sanomaaccount,article) -> 1, (lataamo-fi,article) -> 1, (nunl,video-source) -> 1, (pracaoferty-pl,article) -> 1, (libelle-nl-lib,product) -> 1, (thehub-nl,article) -> 1, (ledigajobben-se,article) -> 1, (soppa365-fi,article) -> 1, (tina-tin,article) -> 1, (vtwonen-nl,article) -> 1, (story-nl-sto,article) -> 1, (libelletvnl,article) -> 1, (supersaa,article) -> 1, (grazia-nl-grz,article) -> 1, (kekmama-nl,arti..."}]},"apps":[],"jobName":"paragraph_1533557357438_2029326505","id":"20180806-120917_1076611383","dateCreated":"2018-08-06T12:09:17+0000","dateStarted":"2018-08-06T12:16:48+0000","dateFinished":"2018-08-06T12:36:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:174520"},{"text":"val contentViewsGrouped2 = contentViews\n    .map{case(site, contentType) => ((site, contentType), 1)}\n    .reduceByKey(_+_)","user":"R.Partapsing","dateUpdated":"2018-08-06T12:18:18+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"contentViewsGrouped2: org.apache.spark.rdd.RDD[((String, com.sanoma.cda.sac.events.ContentItemType), Int)] = ShuffledRDD[44] at reduceByKey at <console>:43\n"}]},"apps":[],"jobName":"paragraph_1533557455089_1903082893","id":"20180806-121055_186458171","dateCreated":"2018-08-06T12:10:55+0000","dateStarted":"2018-08-06T12:18:18+0000","dateFinished":"2018-08-06T12:36:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:174521"},{"text":"contentViewsGrouped2.take(1000)","user":"R.Partapsing","dateUpdated":"2018-08-06T12:48:28+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res10: Array[((String, com.sanoma.cda.sac.events.ContentItemType), Int)] = Array(((oikotie-fi,article),5582), ((grazia-nl-grz,article),1), ((sanomakauppa-fi,article),480), ((gloria-fi,article),7871), ((styletoday-nl,product),490), ((styletoday-nl,article),38008), ((sanoma-nl,article),834), ((fashionchick-nl,product),42662), ((supla-fi,article),7994), ((nunl,video),528774), ((lindatv,article),11747), ((sanoma-tijdschriftcadeau-site,article),8), ((radiosuomipop-fi,article),617), ((avointyopaikka-fi,article),14849), ((sanomaaccount,article),1719), ((hyvaterveys-fi,article),50911), ((hs,article),3308671), ((lataamo-fi,article),50797), ((radiorock-fi,article),380), ((libelletvnl,video-source),14580), ((duckstadtypen-nl,article),11880), ((kekmama-nl,article),57127), ((etlehti-fi,article),4215..."}]},"apps":[],"jobName":"paragraph_1533557898099_169031635","id":"20180806-121818_1280094508","dateCreated":"2018-08-06T12:18:18+0000","dateStarted":"2018-08-06T12:48:28+0000","dateFinished":"2018-08-06T13:13:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:174522"},{"text":"%md\n### DataFrames","user":"R.Partapsing","dateUpdated":"2018-08-06T15:06:16+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>DataFrames</h3>\n"}]},"apps":[],"jobName":"paragraph_1533567961767_1057035836","id":"20180806-150601_204907939","dateCreated":"2018-08-06T15:06:01+0000","dateStarted":"2018-08-06T15:06:16+0000","dateFinished":"2018-08-06T15:06:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:174523"},{"text":"val contentViewsDF = sacWeb\n    .filter( event => event.content.isDefined)\n    .map{ event => \n        val contentId = event.content.get \n        val contentType = contentId.contentType\n        (event.sit, contentType.toString)\n    }\n    .toDF(\"site\", \"contentType\")","user":"R.Partapsing","dateUpdated":"2018-08-06T12:54:21+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1533559554197_1294613160","id":"20180806-124554_1293607316","dateCreated":"2018-08-06T12:45:54+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:174524"},{"text":"z.show(contentViewsDF)","user":"R.Partapsing","dateUpdated":"2018-08-06T12:54:40+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1533560062350_-756947885","id":"20180806-125422_294423330","dateCreated":"2018-08-06T12:54:22+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:174525"},{"text":"val contentViewCountDF = contentViewsDF\n    .groupBy(\"site\", \"contentType\")\n        .count","user":"R.Partapsing","dateUpdated":"2018-08-06T12:55:39+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1533560080300_925204954","id":"20180806-125440_462416672","dateCreated":"2018-08-06T12:54:40+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:174526"},{"text":"z.show(contentViewCountDF)","user":"R.Partapsing","dateUpdated":"2018-08-06T12:56:07+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1533560139126_148289656","id":"20180806-125539_1194857170","dateCreated":"2018-08-06T12:55:39+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:174527"},{"text":"%md\n### DataSets","user":"R.Partapsing","dateUpdated":"2018-08-06T15:07:53+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>DataSets</h3>\n"}]},"apps":[],"jobName":"paragraph_1533568060116_773045175","id":"20180806-150740_2142216518","dateCreated":"2018-08-06T15:07:40+0000","dateStarted":"2018-08-06T15:07:53+0000","dateFinished":"2018-08-06T15:07:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:174528"},{"text":"case class ContentView(site: String, contentType: String)","user":"R.Partapsing","dateUpdated":"2018-08-06T15:03:43+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"defined class ContentView\n"}]},"apps":[],"jobName":"paragraph_1533562149760_-295476900","id":"20180806-132909_1401821936","dateCreated":"2018-08-06T13:29:09+0000","dateStarted":"2018-08-06T15:03:43+0000","dateFinished":"2018-08-06T15:03:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:174529"},{"text":"val contentViewDS = sacWeb\n    .filter( event => event.content.isDefined)\n    .map{ event => \n        val contentId = event.content.get \n        val contentType = contentId.contentType\n        ContentView(event.sit, contentType.toString)\n    }\n    .toDS()","user":"R.Partapsing","dateUpdated":"2018-08-06T15:05:05+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"contentViewDS: org.apache.spark.sql.Dataset[ContentView] = [site: string, contentType: string]\n"}]},"apps":[],"jobName":"paragraph_1533562181737_-9177746","id":"20180806-132941_1755022467","dateCreated":"2018-08-06T13:29:41+0000","dateStarted":"2018-08-06T15:05:05+0000","dateFinished":"2018-08-06T15:05:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:174530"},{"text":"val contentTypeViewCount = contentViewDS\n    .groupBy(\"contentType\")\n        .count","user":"R.Partapsing","dateUpdated":"2018-08-06T15:05:28+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"contentTypeViewCount: org.apache.spark.sql.DataFrame = [contentType: string, count: bigint]\n"}]},"apps":[],"jobName":"paragraph_1533566940734_-325810242","id":"20180806-144900_745691961","dateCreated":"2018-08-06T14:49:00+0000","dateStarted":"2018-08-06T15:05:28+0000","dateFinished":"2018-08-06T15:05:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:174531"},{"text":"z.show(contentTypeViewCount)","user":"R.Partapsing","dateUpdated":"2019-01-29T13:41:08+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"contentType":"string","count":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"contentType\tcount\narticle\t44511502\nvideo\t1479383\nproduct\t114574\nvideo-source\t46119\njob-ad\t51574\n"}]},"apps":[],"jobName":"paragraph_1533567928678_2111385740","id":"20180806-150528_659396292","dateCreated":"2018-08-06T15:05:28+0000","dateStarted":"2018-08-06T15:05:41+0000","dateFinished":"2018-08-06T15:10:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:174532"},{"text":"%md \n### Executing Hive queries","user":"R.Partapsing","dateUpdated":"2018-08-06T15:08:15+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Executing Hive queries</h3>\n"}]},"apps":[],"jobName":"paragraph_1533567941053_611249778","id":"20180806-150541_1019053845","dateCreated":"2018-08-06T15:05:41+0000","dateStarted":"2018-08-06T15:08:15+0000","dateFinished":"2018-08-06T15:08:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:174533"},{"text":"val query = s\"SELECT * FROM smbene_sac.web_events WHERE day BETWEEN '$dateFrom' AND '$dateFrom'\"\nval hiveQuery = spark.sql(query)","user":"R.Partapsing","dateUpdated":"2018-08-06T15:10:58+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"query: String = SELECT * FROM smbene_sac.web_events WHERE day BETWEEN '2018-08-05' AND '2018-08-05'\nhiveQuery: org.apache.spark.sql.DataFrame = [ts: string, user_id: string ... 13 more fields]\n"}]},"apps":[],"jobName":"paragraph_1533568095068_919062578","id":"20180806-150815_670773556","dateCreated":"2018-08-06T15:08:15+0000","dateStarted":"2018-08-06T15:10:58+0000","dateFinished":"2018-08-06T15:10:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:174534"},{"text":"z.show(hiveQuery.groupBy(\"site\").count())","user":"R.Partapsing","dateUpdated":"2019-01-29T13:41:08+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"site":"string","count":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"site\tcount\nsbs6-nl-sbs6\t225\nstory-nl-sto\t168489\nlindatv\t44828\nfashionchick-nl\t231616\ntheaterclub-nl\t2812\nveronica-magazine\t1483\nessent\t1\nthehub-nl\t18\nschoolbank-nl-sb\t38555\nlibellelekkerbe\t2\nsanoma-nl\t4903\nscholieren-com-slc\t46455\ngrazia-nl-grz\t1\nnuwerk-nl\t20597\nstartpagina.nl\t313\nfashionchick-nl-fsc\t102\nfemmesdaujourdhuidelicesbe\t9\nstartgoogle.startpagina.nl\t876673\nmyhomeshopping-nl-mhs\t1\nmargriet-nl-mar\t289585\nnusport-nl\t748\nsanoma-margriet_bundelshop-site\t15738\nvtwonen-nl\t267010\ntjox.nl\t4045\nflowmagazine-nl-flm\t8253\nflaironline-nl\t73\nlinda-magazine-lin\t925570\noudersvannu-nl\t338462\nkekmama-nl\t58825\nfashionista-nl-nl\t4122\nlibellemama-nl-nl\t8798\ngael-fr-fr\t9468\nduckstadtypen-nl\t12690\nevents\t1772\nfemmesdelices-fr-fr\t10826\nadverterennunl\t349\nflair-nl-nl\t188698\ndonaldduck-nl-don\t37200\nlibelle-nl-nl\t59090\np4442.libelle\t23\nsanoma-tijdschrift-site\t13374\nlibelletv\t218\nflairathome-nl\t60820\nlibelle.lekker\t61\nnufoto-nl-nuf\t11\nzie-nl\t342\nnationaletijdschriftenbon-nl\t2267\nhartvannederland-nl-hvnl\t1\ntina-tin\t4999\np4442.flairnl\t27\nstyletoday-nl\t41976\nsuperguidenl\t24801\nnouveau-nl-nov\t40149\nsanoma-tijdschriftcadeau-site\t14143\nflowmagazine-com\t4613\ngoeievraag-nl-gvr\t713160\nsanoma-magazine2-site\t37954\nlibellecommunie-nl-nl\t92\nkuma-nl\t118760\nactieauto-nl\t643\np4442.flairfr\t9\nlibelletvnl\t76376\nfeeling-nl-nl\t37756\n123tijdschrift-nl\t2551\nzozitdat-nl-zzd\t2027\nproefabonnementen-nl\t488\nblogtoday-nl-btd\t71341\nlibellezomerweek-nl\t2065\nautoweek-nl\t508782\nfemmesdaujourdhuimaman-fr-fr\t12905\nliving-nl\t1657\nmargriet-vrindinnen.nl\t2820\nflair-fr-fr\t82247\nteleviziernl\t47437\ntvgids-nl-tvg\t530946\nnunl\t25331670\np4442.libellemama\t19049\np4442.feeling\t2\nbe_femmesdaujourdhui\t2\nconsentbar_sanoma_nl\t3571586\nscoupy-nl\t14760\nstartpagina-themas-nl\t227281\ntotaaltv-nl-ttv\t45192\nnuadverteren-nl\t324\ncontentplatform.sanoma.com\t2\nathene\t10\nlibelle-nl-lib\t547313\nfemmesdaujourdhui-fr-fr\t25226\nviva-nl\t1347755\nvtwonen-be\t11932\nlindafestival-nl\t1425\nveronica-tv-vcr\t1\nlibellelekker-nl-nl\t112715\nstartpagina-nl-spa\t2251310\ndonaldduck-nl\t155\n"}]},"apps":[],"jobName":"paragraph_1533568124691_-743776196","id":"20180806-150844_1978653630","dateCreated":"2018-08-06T15:08:44+0000","dateStarted":"2018-08-06T15:11:03+0000","dateFinished":"2018-08-06T15:11:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:174535"},{"text":"","user":"R.Partapsing","dateUpdated":"2019-01-07T14:47:20+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533568263006_-345344901","id":"20180806-151103_657932503","dateCreated":"2018-08-06T15:11:03+0000","dateStarted":"2019-01-07T14:47:20+0000","dateFinished":"2019-01-07T14:47:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:174536"},{"text":"%spark_dennis\n","user":"R.Partapsing","dateUpdated":"2019-01-07T14:47:19+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1546872439913_1062177496","id":"20190107-144719_998904515","dateCreated":"2019-01-07T14:47:19+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:174537"}],"name":"/Rakesh/intro/SACLog","id":"2DQ6Z6RN7","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark_ruben:shared_process":[],"spark_dennis:shared_process":[],"rakesh-spark:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}